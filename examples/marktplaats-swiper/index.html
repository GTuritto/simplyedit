<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Swiper demo</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">

	<!-- Link Swiper's CSS -->
	<link rel="stylesheet" href="swiper.min.css">
	<link rel="stylesheet" href="demo.css">
</head>
<body>
	<!-- Swiper -->
	<div class="swiper-container">
		<div class="swiper-wrapper" data-simply-data="marktplaatsList" data-simply-list="swiper">
			<template>
				<div class="swiper-slide article">
					<h1 data-simply-field="title">title</h1>
					<div class="image" data-simply-field="image"></div>
					<div class="description">
						<span class="prijs" data-simply-field="prijs">prijs</span><br>
						<!-- span data-simply-field="datum">datum</span><br><br -->
						<br><span data-simply-field="description">prijs</span><br>
					</div>
					<div class="link">&raquo; <a href="#" data-simply-field="url">Bekijk op marktplaats</a></div>
				</div>
			</template>
		</div>
		<!-- Add Pagination -->
		<div class="swiper-pagination"></div>
		<!-- Add Arrows -->
		<div class="swiper-button-next"></div>
		<div class="swiper-button-prev"></div>
	</div>

	<!-- Swiper JS -->
	<script src="swiper.min.js"></script>

	<!-- Initialize Swiper -->
	<script src="/simply-edit/js/simply-edit.js" 
		data-api-key="muze" 
		data-simply-endpoint="http://yvo.muze.nl/ariadne/loader.php/system/users/yvo/simply-store/"
		data-simply-images="http://yvo.muze.nl/ariadne/loader.php/system/users/yvo/simply-store/img/"
	></script>
	<script>
		var http = new XMLHttpRequest();
		var url = "http://crossorigin.me/http://www.rss-widget.nl/opensearch.php?s=30&ui=14863699";

		http.open("GET", url, true);
		http.onreadystatechange = function() {//Call a function when the state changes.
			if(http.readyState == 4) {
				if (http.status == 200) {
					var parser = new DOMParser();
					var xmlDoc = parser.parseFromString(http.responseText.replace(/\]\]\>/g, " ]]>"), "text/xml");

					var items = xmlDoc.querySelectorAll("item");
					var result = [];
					for (var i=0; i<items.length; i++) {
						var desc = items[i].querySelector("description").childNodes[0].nodeValue;
						var descInfo = desc.split(" - ");

						result.push({
							title : items[i].querySelector("title").innerHTML.replace("&amp;", "&").replace(/^Aangeboden: /, ''),
							image : descInfo[0],
							prijs : descInfo[1],
							datum : descInfo[2],
							description : descInfo[3],
							url : {
								href : items[i].querySelector("link").innerHTML.replace("&amp;", "&")
							},
							"data-simply-template" : ((i < 2) ? "large" : "small" )
						});
					}
					editor.addDataSource("marktplaatsList", {
						load : result
					});
				
					var initSwiper = function() {
						if (document.querySelector(".swiper-wrapper.simply-empty")) {
							console.log('hier');
							window.setTimeout(initSwiper, 100);
							return;
						}
						var swiper = new Swiper('.swiper-container', {
							pagination: '.swiper-pagination',
							paginationClickable: true,
							nextButton: '.swiper-button-next',
							prevButton: '.swiper-button-prev',
							spaceBetween: 30
						});
					};
					initSwiper();
				}
			}
		};
		http.send();
	</script>
</body>
</html>