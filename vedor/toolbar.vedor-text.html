<section id="vedor-text-cursor" class="vedor-section">
	<h1>*HTML Toolbar for Text Cursor*</h1>
	<div class="vedor-toolbar">
		<ul class="vedor-buttons">
			<li><button data-vedor-section="vedor-text-style" class="vedor-expands"><i class="fa fa-magic"></i>Style</button></li>
			<li><button data-vedor-section="vedor-text-align" class="vedor-expands"><i class="fa fa-align-left"></i>Align</button></li>
			<li><button data-vedor-section="vedor-clipboard" class="vedor-expands"><i class="fa fa-clipboard"></i>Clipboard</button></li>
			<li><button data-vedor-section="vedor-insert" class="vedor-expands"><i class="fa fa-plus"></i>Insert</button></li>
		</ul>
		<div class="vedor-toolbar-section vedor-text-style">
			<ul>
				<li class="vedor-text-format"><select name="textStyle" data-vedor-action="vedor-text-blockstyle">
					<option value="h1">Heading 1</option>
					<option value="h2">Heading 2</option>
					<option value="h3">Heading 3</option>
					<option value="p">Paragraph</option>
					<option value="ul">Unnumbered list</option>
					<option value="ol">Numbered list</option>
				</select></li>
				<!-- li class="vedor-text-bold"><button data-vedor-action="vedor-text-bold"><i class="fa fa-bold"></i>Bold</button></li>
				<li class="vedor-text-italic"><button data-vedor-action="vedor-text-italic"><i class="fa fa-italic"></i>Italic</button></li>
				<li class="vedor-text-underline"><button data-vedor-action="vedor-text-underline"><i class="fa fa-underline"></i>Underline</button></li -->
			</ul>
		</div>
		<div class="vedor-toolbar-section vedor-text-align" data-type="vedor-buttongroup-radio">
			<ul>
			<li><button data-vedor-action="vedor-text-align-left" data-value="left" class="vedor-align-left"><i class="fa fa-align-left"></i>Left</button></li>
			<li><button data-vedor-action="vedor-text-align-center" data-value="center" class="vedor-align-center"><i class="fa fa-align-center"></i>Center</button></li>
			<li><button data-vedor-action="vedor-text-align-right" data-value="right" class="vedor-align-right"><i class="fa fa-align-right"></i>Right</button></li>
			<li><button data-vedor-action="vedor-text-align-justify" data-value="justify" class="vedor-align-justify"><i class="fa fa-align-justify"></i>Justify</button></li>
			</ul>
		</div>
		<div class="vedor-toolbar-section vedor-insert">
			<ul>
				<li><button data-vedor-action="vedor-insert-image" data-vedor-section="vedor-insert-image"><i class="fa fa-picture-o"></i>Image</button></li>
				<!-- li><button data-vedor-action="vedor-insert-table" data-vedor-section="vedor-insert-table"><i class="fa fa-table"></i>Table
					<div id="vdTablePopup" style="display: none;" unselectable="on">
						<div id="vdTablePreview" unselectable="on">
						</div>
						<div id="vdTableText" unselectable="on">
						</div>
					</div>
				</button></li -->
				<!-- li><button data-vedor-action="vedor-insert-symbol" data-vedor-section="vedor-insert-symbol"><i class="fa fa-eur"></i>Symbol</button></li -->
				<li><button data-vedor-action="vedor-insert-gadget" data-vedor-section="vedor-insert-gadget"><i class="fa fa-puzzle-piece"></i>Gadget</button></li>
				<li><button data-vedor-action="vedor-insert-source" data-vedor-section="vedor-insert-source"><i class="fa fa-code"></i>Code</button></li>
			</ul>
		</div>
		<div class="vedor-toolbar-section vedor-clipboard">
			<ul>
				<li><button class="vedor-clipboard-paste"><i class="fa fa-clipboard"></i>Paste</button></li>
				<li><button class="vedor-clipboard-select-all" data-vedor-action="vedor-clipboard-select-all"><i class="fa fa-arrows-alt"></i>Select all</button></li>
			</ul>
		</div>
	</div>
</section>
<section id="vedor-text-selection" class="vedor-section">
	<h1>*HTML Toolbar for Text Selection*</h1>
	<div class="vedor-toolbar">
		<ul class="vedor-buttons">
			<li><button data-vedor-section="vedor-text-style" class="vedor-expands"><i class="fa fa-magic"></i>Style</button></li>
			<li><button data-vedor-section="vedor-text-align" class="vedor-expands"><i class="fa fa-align-left"></i>Align</button></li>
			<li><button data-vedor-section="vedor-clipboard" class="vedor-expands"><i class="fa fa-clipboard"></i>Clipboard</button></li>
			<li><button data-vedor-action="vedor-hyperlink-insert" data-vedor-section="vedor-hyperlink"><i class="fa fa-link"></i>Link</button></li>
			<li><button data-vedor-section="vedor-code" data-vedor-action="vedor-edit-source"><i class="fa fa-code"></i>Code</button></li>
		</ul>
		<div class="vedor-toolbar-section vedor-text-style">
			<ul>
				<li class="vedor-text-format"><select name="textStyle" data-vedor-action="vedor-text-blockstyle">
					<option value="h1">Heading 1</option>
					<option value="h2">Heading 2</option>
					<option value="h3">Heading 3</option>
					<option value="p">Paragraph</option>
					<option value="ul">Unnumbered list</option>
					<option value="ol">Numbered list</option>
				</select></li>
				<li class="vedor-text-bold"><button data-vedor-action="vedor-text-bold"><i class="fa fa-bold"></i>Bold</button></li>
				<li class="vedor-text-italic"><button data-vedor-action="vedor-text-italic"><i class="fa fa-italic"></i>Italic</button></li>
				<li class="vedor-text-underline"><button data-vedor-action="vedor-text-underline"><i class="fa fa-underline"></i>Underline</button></li>
			</ul>
		</div>
		<div class="vedor-toolbar-section vedor-text-align" data-type="vedor-buttongroup-radio">
			<ul>
			<li><button data-vedor-action="vedor-text-align-left" data-value="left" class="vedor-align-left"><i class="fa fa-align-left"></i>Left</button></li>
			<li><button data-vedor-action="vedor-text-align-center" data-value="center" class="vedor-align-center"><i class="fa fa-align-center"></i>Center</button></li>
			<li><button data-vedor-action="vedor-text-align-right" data-value="right" class="vedor-align-right"><i class="fa fa-align-right"></i>Right</button></li>
			<li><button data-vedor-action="vedor-text-align-justify" data-value="justify" class="vedor-align-justify"><i class="fa fa-align-justify"></i>Justify</button></li>
			</ul>
		</div>
		<div class="vedor-toolbar-section vedor-clipboard">
			<ul>
				<li><button class="vedor-clipboard-cut"><i class="fa fa-scissors"></i>Cut</button></li>
				<li><button class="vedor-clipboard-copy"><i class="fa fa-files-o"></i>Copy</button></li>
				<li><button class="vedor-clipboard-paste"><i class="fa fa-clipboard"></i>Paste</button></li>
				<li><button class="vedor-clipboard-select-all" data-vedor-action="vedor-clipboard-select-all"><i class="fa fa-arrows-alt"></i>Select all</button></li>
			</ul>
		</div>
	</div>
</section>
<script type="text/javascript">
	editor.plugins.text = {
		formatInline : function(command, value) {
			var field=editor.node.getEditableField();
			if (!field) {
				return;
			}
			registerChange(field.id);

			var sel = vdSelectionState.get();

			var target = document;
			if( !window.getSelection && target.selection.type != "None" ) { // make sure we execCommand on the selection for IE.
				target = sel;
			}

			editor.node.replaceTags("STRONG", "B");
			editor.node.replaceTags("EM", "I");
			target.execCommand(command, false, value);
			vdSelectionState.restore();

			editor.node.replaceTags("I", "EM");
			editor.node.replaceTags("B", "STRONG");

			vdStoreUndo();
			vdEditPane_DisplayChanged();
			return true;
		},
		formatBlock : function(styleInfo) {
			var field=editor.node.getEditableField();
			if (!field) {
				return false;
			}

			vedor.editor.styles.init(window);
			vedor.editor.styles.format(styleInfo, field);

			vdStoreUndo();

			vdEditPane_DisplayChanged();
			return true;
		}
	};
		
	editor.addToolbar({
		"name" : "vedor-text-cursor",
		"filter" : {
			"sel-collapsed" : true
		}
	});

	editor.addToolbar({
		name : "vedor-text-selection",
		update : function(el) {
			var i;
			var sel = vdSelectionState.get();
			if (sel) {
				var parent = vdSelection.getNode(sel);
				if (parent || parent.getAttribute || parent.getAttribute("contenteditable")) {
					var parentStyles = editor.node.getAllStyles(parent);

					var textAlign = document.querySelectorAll(".vedor-text-align[data-type=vedor-buttongroup-radio]");
					for (i=0; i<textAlign.length;i++) {
						switch (parentStyles["text-align"]) {
							case "right" :
								vdSetProperty(textAlign[i], "right");
							break;
							case "center" :
								vdSetProperty(textAlign[i], "center");
							break;
							case "justify" :
								vdSetProperty(textAlign[i], "justify");
							break;
							case "left" :
								vdSetProperty(textAlign[i], "left");
							break;
							default :
								vdSetProperty(textAlign[i], "left");
							break;
						}
					}

					// Set the parent icon for alignment as well;
					var currentIcon = document.querySelectorAll("div.vedor-text-align button.vedor-selected i")[0];
					var icons = document.querySelectorAll("button[data-vedor-section=vedor-text-align] i");
					for (i=0; i<icons.length; i++) {
						icons[i].className = currentIcon.className;
					}

					// Check "Bold"
					var textBold = document.querySelectorAll(".vedor-text-bold button");
					for (i=0; i<textBold.length; i++) {
						if (parentStyles["font-weight"] == "bold") {
							textBold[i].classList.add("vedor-selected");
						} else {
							textBold[i].classList.remove("vedor-selected");
						}
					}

					// Check "Italic"
					var textItalic = document.querySelectorAll(".vedor-text-italic button");
					for (i=0; i<textItalic.length; i++) {
						if (parentStyles["font-style"] == "italic") {
							textItalic[i].classList.add("vedor-selected");
						} else {
							textItalic[i].classList.remove("vedor-selected");
						}
					}

					// Check "Underline"
					var textUnderline = document.querySelectorAll(".vedor-text-underline button");
					for (i=0; i<textUnderline.length; i++) {
						if (parentStyles["text-decoration"].match(/underline/)) {
							textUnderline[i].classList.add("vedor-selected");
						} else {
							textUnderline[i].classList.remove("vedor-selected");
						}
					}
				}
			}
			return true;
		},
		filter : {
			"sel-collapsed" : false
		},
		actions : {
			'vedor-text-bold' : function() {
				editor.plugins.text.formatInline("Bold");
			},
			'vedor-text-italic' : function() {
				editor.plugins.text.formatInline("Italic");
			},
			'vedor-text-underline' : function() {
				editor.plugins.text.formatInline("Underline");
			},
			'vedor-text-align-left' : function() {
				editor.plugins.text.formatInline("JustifyLeft");
			},
			'vedor-text-align-right' : function() {
				editor.plugins.text.formatInline("JustifyRight");
			},
			'vedor-text-align-center' : function() {
				editor.plugins.text.formatInline("JustifyCenter");
			},
			'vedor-text-align-justify' : function() {
				editor.plugins.text.formatInline("JustifyFull");
			},
			'vedor-text-align-left' : function() {
				editor.plugins.text.formatInline("JustifyLeft");
			},
			'vedor-text-blockstyle' : function(value) {
				editor.plugins.text.formatBlock(value);
			}
		}
	});
</script>